<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Form Antrian</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      max-width: 600px;
      margin: 20px auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 10px;
    }
    label {
      margin-top: 10px;
      display: block;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
    }
    button {
      margin-top: 10px;
      padding: 10px;
      width: 100%;
    }
    iframe {
      width: 100%;
      min-height: 150px;
      border: 1px solid #ddd;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="serverTime" style="font-weight: bold; margin-bottom: 10px;">
  Waktu Saat Ini: Memuat...
  </div>
  <h2>Form Antrian</h2>

  <!-- Form -->
  <form 
    id="antrianForm"
    action="https://antrianpanganbersubsidi.pasarjaya.co.id/is0ufr88unmal65snmilpr6345_api_2025.php"
    method="post"
    target="outputFrame"
  >
    <label for="tanggal_ambil">Tanggal Ambil</label>
    <input type="date" id="tanggal_ambil" name="tanggal_ambil" required>

    <label for="wilayah">Wilayah</label>
    <select id="wilayah" name="wilayah" required>
      <option value="">Pilih Wilayah</option>
      <option value="5">Jakarta Barat</option>
      <option value="1">Jakarta Pusat</option>
    </select>

    <label for="lokasi">Lokasi</label>
    <select id="lokasi" name="lokasi" required>
      <option value="">Pilih Lokasi</option>
      <option value="56">Mini DC Grogol</option>
      <option value="151">Mini DC Pasar Senen Blok III</option>
      <option value="68">Pasar Pos Pengumben</option>
    </select>

    <label for="kk">Nomor KK</label>
    <input type="text" id="kk" name="kk" required>

    <label for="ktp">Nomor KTP</label>
    <input type="text" id="ktp" name="ktp" required>

    <label for="kartu">Nomor Kartu</label>
    <input type="text" id="kartu" name="kartu" required>

    <label for="tgllahir">Tanggal Lahir</label>
    <input type="date" id="tgllahir" name="tgllahir" required>

    <input type="hidden" name="captha" value="">
    <!--label><input type="checkbox" name="box" checked> Saya setuju dengan ketentuan</label-->
    <input type="hidden" name="daterange-btn" value="simpan">

    <button type="submit">Kirim</button>
  </form>

  <!-- Simpan & Load -->
  <hr>
  <label for="namaSimpan">Simpan Data Sebagai:</label>
  <input type="text" id="namaSimpan" placeholder="Contoh: Data Ramadhan">
  <button onclick="simpanData()">üíæ Simpan</button>

  <label for="dataTersimpan">Panggil Data Tersimpan:</label>
  <select id="dataTersimpan"></select>
  <button onclick="muatData()">üì§ Muat</button>
  <button onclick="location.reload()">üîÑ Refresh Halaman</button>

  <!-- Target hasil kiriman -->
  <iframe name="outputFrame" id="outputFrame"></iframe>

  <script>
    // Menjalankan jam dari waktu lokal browser
function startLocalClock() {
  function updateClock() {
    const now = new Date();
    const jam = String(now.getHours()).padStart(2, '0');
    const menit = String(now.getMinutes()).padStart(2, '0');
    const detik = String(now.getSeconds()).padStart(2, '0');
    document.getElementById('serverTime').textContent = `Waktu Saat Ini: ${jam}:${menit}:${detik}`;
  }

  updateClock(); // tampil pertama
  setInterval(updateClock, 1000); // update tiap detik
}
  window.onload = function() {
  startLocalClock(); // ‚Üê pakai waktu lokal
};
    // Set tanggal ambil ke H+1
    const tanggalAmbil = document.getElementById('tanggal_ambil');
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    const yyyy = tomorrow.getFullYear();
    const mm = String(tomorrow.getMonth() + 1).padStart(2, '0');
    const dd = String(tomorrow.getDate()).padStart(2, '0');
    const nextDay = `${yyyy}-${mm}-${dd}`;
    tanggalAmbil.value = nextDay;

    // Simpan data ke localStorage
    function simpanData() {
      const nama = document.getElementById('namaSimpan').value.trim();
      if (!nama) {
        alert("Masukkan nama untuk menyimpan data!");
        return;
      }

      const data = {
        wilayah: document.getElementById('wilayah').value,
        lokasi: document.getElementById('lokasi').value,
        kk: document.getElementById('kk').value,
        ktp: document.getElementById('ktp').value,
        kartu: document.getElementById('kartu').value,
        tgllahir: document.getElementById('tgllahir').value,
      };

      localStorage.setItem('data_' + nama, JSON.stringify(data));
      updateDropdown();
      alert("‚úÖ Data berhasil disimpan sebagai: " + nama);
      document.getElementById('namaSimpan').value = '';
    }

    // Update dropdown data tersimpan
    function updateDropdown() {
      const select = document.getElementById('dataTersimpan');
      select.innerHTML = '';
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('data_')) {
          const option = document.createElement('option');
          option.value = key;
          option.textContent = key.replace('data_', '');
          select.appendChild(option);
        }
      }
    }

    // Muat data dari localStorage
    function muatData() {
      const selectedKey = document.getElementById('dataTersimpan').value;
      if (!selectedKey) return;
      const data = JSON.parse(localStorage.getItem(selectedKey));
      document.getElementById('wilayah').value = data.wilayah;
      document.getElementById('lokasi').value = data.lokasi;
      document.getElementById('kk').value = data.kk;
      document.getElementById('ktp').value = data.ktp;
      document.getElementById('kartu').value = data.kartu;
      document.getElementById('tgllahir').value = data.tgllahir;
    }

    // Inisialisasi dropdown saat halaman dimuat
    window.onload = updateDropdown;
  </script>
</body>
</html>

